{"version":3,"sources":["../../../modules/pie-chart/hybrid/index.js"],"names":["color","domain","pie","value","d","sort","getSliceFill","i","data","getLabelText","key","PieChart","array","isRequired","innerHoleSize","number","size","padding","labels","bool","styles","object","mouseOverHandler","func","mouseOutHandler","mouseMoveHandler","clickHandler","props","uid","currentSlices","currentLabels","tweenSlice","slice","index","currentSlice","t","getSliceArc","initialise","transition","innerRadius","getInnerRadius","outerRadius","getOuterRadius","radius","datum","selectAll","node","Element","setAttribute","text","getLabels","getLabelArcTransform","getLabelArc","centroid","labelX","labelY","enter","append","attr","each","push","mouseover","mouseout","mousemove","click","path","getSlices","on","initialiseSlices","initialiseLabels","n","length","duration","attrTween","splice","exit","remove","transitionSlices","transitionLabels","root","scope","rules","createSvgNode","createSvgRoot","p","calculateChartParameters","createSlices","createLabels","className","createStyle","toReact"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AAUA;;AAIA;;;;AACA;;;;AACA;;AACA;;;;;;AAEA,IAAMA,QAAQ,0CAA+BC,MAA/B,CAAsC,cAAM,CAAN,EAAS,EAAT,CAAtC,CAAd;AACA,IAAMC,MAAM,cACTC,KADS,CACH,UAACC,CAAD;AAAA,SAAOA,EAAED,KAAT;AAAA,CADG,EAETE,IAFS,CAEJ,IAFI,CAAZ;;AAIA,IAAMC,eAAe,SAAfA,YAAe,CAACF,CAAD,EAAIG,CAAJ;AAAA,SAClBH,EAAEI,IAAF,CAAOR,KAAR,GACII,EAAEI,IAAF,CAAOR,KADX,GAEIA,MAAMO,CAAN,CAHe;AAAA,CAArB;;AAKA,IAAME,eAAe,SAAfA,YAAe,CAACL,CAAD;AAAA,SAAOA,EAAEI,IAAF,CAAOE,GAAd;AAAA,CAArB;;IAEqBC,Q;;;;wBACI;AACrB,aAAO;AACLH,cAAM,oBAAUI,KAAV,CAAgBC,UADjB;AAELC,uBAAe,oBAAUC,MAFpB;AAGLC,cAAM,oBAAUD,MAHX;AAILE,iBAAS,oBAAUF,MAJd;AAKLG,gBAAQ,oBAAUC,IALb;AAMLC,gBAAQ,oBAAUC,MANb;AAOLC,0BAAkB,oBAAUC,IAPvB;AAQLC,yBAAiB,oBAAUD,IARtB;AASLE,0BAAkB,oBAAUF,IATvB;AAULG,sBAAc,oBAAUH;AAVnB,OAAP;AAYD;;;wBAEyB;AACxB,aAAO;AACLP,cAAM,GADD;AAELF,uBAAe,CAFV;AAGLG,iBAAS,CAHJ;AAILC,gBAAQ,KAJH;AAKLE,gBAAQ,EALH;AAMLE,0BAAkB,4BAAM,CAAE,CANrB;AAOLE,yBAAiB,2BAAM,CAAE,CAPpB;AAQLC,0BAAkB,4BAAM,CAAE,CARrB;AASLC,sBAAc,wBAAM,CAAE;AATjB,OAAP;AAWD;;;AAED,oBAAYC,KAAZ,EAAmB;AAAA;;AAAA,0IACXA,KADW;;AAEjB,UAAKC,GAAL,GAAW,4BAAeD,KAAf,CAAX;AACA,UAAKE,aAAL,GAAqB,EAArB;AACA,UAAKC,aAAL,GAAqB,EAArB;AACA,UAAKC,UAAL,GAAkB,UAACC,KAAD,EAAQC,KAAR,EAAkB;AAClC,UAAMC,eAAe,MAAKL,aAAL,CAAmBI,KAAnB,CAArB;AACA,UAAM1B,IAAI,oBAAY2B,YAAZ,EAA0BF,KAA1B,CAAV;AACA,YAAKH,aAAL,CAAmBI,KAAnB,IAA4BD,KAA5B;AACA,aAAO,UAACG,CAAD;AAAA,eAAO,MAAKC,WAAL,GAAmB7B,EAAE4B,CAAF,CAAnB,CAAP;AAAA,OAAP;AACD,KALD;AALiB;AAWlB;;;;wCAEmB;AAClB,WAAKE,UAAL;AACD;;;yCAEoB;AACnB,WAAKC,UAAL;AACD;;;kCAEa;AAAA,UAEVrB,OAFU,GAGR,KAAKU,KAHG,CAEVV,OAFU;;;AAKZ,UAAMsB,cAAc,KAAKC,cAAL,EAApB;AACA,UAAMC,cAAc,KAAKC,cAAL,EAApB;;AAEA,aAAO,cACJH,WADI,CACQA,cAActB,OADtB,EAEJwB,WAFI,CAEQA,cAAcxB,OAFtB,CAAP;AAGD;;;kCAEa;AAAA,UAEVA,OAFU,GAGR,KAAKU,KAHG,CAEVV,OAFU;;;AAKZ,UAAMwB,cAAc,KAAKC,cAAL,EAApB;AACA,UAAMC,SAASF,cAAcxB,OAAd,GAA0B,KAAKwB,WAAN,GAAqB,GAA7D;;AAEA,aAAO,cACJA,WADI,CACQE,MADR,EAEJJ,WAFI,CAEQI,MAFR,CAAP;AAGD;;;qCAEgB;AACf,aAAO,KAAKhB,KAAL,CAAWX,IAAX,GAAkB,GAAzB;AACD;;;qCAEgB;AACf,aAAO,KAAKW,KAAL,CAAWb,aAAX,GAA2B,GAAlC;AACD;;;gCAEW;AAAA,UAERN,IAFQ,GAGN,KAAKmB,KAHC,CAERnB,IAFQ;;;AAKV,UAAMoB,MAAM,KAAKA,GAAjB;;AAEA,aAAO,4BAAkBA,GAAlB,EACJgB,KADI,CACEpC,IADF,EAEJqC,SAFI,CAEM,MAFN,CAAP;AAGD;;;gCAEW;AAAA,UAERrC,IAFQ,GAGN,KAAKmB,KAHC,CAERnB,IAFQ;;;AAKV,UAAMoB,MAAM,KAAKA,GAAjB;;AAEA,aAAO,4BAAkBA,GAAlB,EACJgB,KADI,CACEpC,IADF,EAEJqC,SAFI,CAEM,MAFN,CAAP;AAGD;;;wCAEuB;AAAA,UAAR7B,IAAQ,QAARA,IAAQ;;AACtB,UAAM8B,OAAO,IAAI,uBAAaC,OAAjB,CAAyB,KAAzB,CAAb;AACAD,WAAKE,YAAL,CAAkB,OAAlB,EAA2BhC,IAA3B;AACA8B,WAAKE,YAAL,CAAkB,QAAlB,EAA4BhC,IAA5B;AACA,aAAO8B,IAAP;AACD;;;yCAEuB;AAAA,UAARA,IAAQ,SAARA,IAAQ;;AACtB,aAAO,eAAOA,IAAP,CAAP;AACD;;;uCAEkB;AAAA;;AACjB,UAAMG,OAAO,KAAKC,SAAL,GACV1C,IADU,CACLN,GADK,CAAb;;AAGA,UAAMiD,uBAAuB,SAAvBA,oBAAuB,CAAC/C,CAAD,EAAO;AAAA,oCACT,OAAKgD,WAAL,GAAmBC,QAAnB,CAA4BjD,CAA5B,CADS;AAAA;AAAA,YAC3BkD,MAD2B;AAAA,YACnBC,MADmB;;AAElC,8BAAoBD,MAApB,UAA+BC,MAA/B;AACD,OAHD;;AAKA,UAAMzB,gBAAgB,KAAKA,aAA3B;;AAEAmB,WACGO,KADH,GAEGC,MAFH,CAEU,MAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,OAHd,EAIGA,IAJH,CAIQ,OAJR,EAIiB,iBAJjB,EAKGA,IALH,CAKQ,WALR,EAKqBP,oBALrB,EAMGF,IANH,CAMQxC,YANR,EAOGkD,IAPH,CAOQ,UAACvD,CAAD;AAAA,eAAO0B,cAAc8B,IAAd,CAAmBxD,CAAnB,CAAP;AAAA,OAPR;AAQD;;;uCAEkB;AAAA,mBAMb,KAAKuB,KANQ;AAAA,UAEfL,gBAFe,UAEfA,gBAFe;AAAA,UAGfE,eAHe,UAGfA,eAHe;AAAA,UAIfC,gBAJe,UAIfA,gBAJe;AAAA,UAKfC,YALe,UAKfA,YALe;;;AAQjB,UAAMmC,YAAY,SAAZA,SAAY,CAACzD,CAAD;AAAA,eAAOkB,iBAAiBlB,CAAjB,WAAP;AAAA,OAAlB;AACA,UAAM0D,WAAW,SAAXA,QAAW,CAAC1D,CAAD;AAAA,eAAOoB,gBAAgBpB,CAAhB,WAAP;AAAA,OAAjB;AACA,UAAM2D,YAAY,SAAZA,SAAY,CAAC3D,CAAD;AAAA,eAAOqB,iBAAiBrB,CAAjB,WAAP;AAAA,OAAlB;AACA,UAAM4D,QAAQ,SAARA,KAAQ,CAAC5D,CAAD;AAAA,eAAOsB,aAAatB,CAAb,WAAP;AAAA,OAAd;;AAEA,UAAMyB,gBAAgB,KAAKA,aAA3B;;AAEA,UAAMoC,OAAO,KAAKC,SAAL,GACV1D,IADU,CACLN,GADK,CAAb;;AAGA+D,WACGT,KADH,GAEGC,MAFH,CAEU,MAFV,EAGGC,IAHH,CAGQ,OAHR,EAGiB,iBAHjB,EAIGA,IAJH,CAIQ,MAJR,EAIgBpD,YAJhB,EAKGoD,IALH,CAKQ,GALR,EAKa,KAAKtB,WAAL,EALb,EAMG+B,EANH,CAMM,WANN,EAMmBN,SANnB,EAOGM,EAPH,CAOM,UAPN,EAOkBL,QAPlB,EAQGK,EARH,CAQM,WARN,EAQmBJ,SARnB,EASGI,EATH,CASM,OATN,EASeH,KATf,EAUGL,IAVH,CAUQ,UAACvD,CAAD;AAAA,eAAOyB,cAAc+B,IAAd,CAAmBxD,CAAnB,CAAP;AAAA,OAVR;AAWD;;;iCAEY;AAAA,UAETc,MAFS,GAGP,KAAKS,KAHE,CAETT,MAFS;;;AAKX,WAAKkD,gBAAL;;AAEA,UAAIlD,MAAJ,EAAY;AACV,aAAKmD,gBAAL;AACD;AACF;;;uCAEkB;AAAA,oBAOb,KAAK1C,KAPQ;AAAA,UAEfnB,IAFe,WAEfA,IAFe;AAAA,UAGfc,gBAHe,WAGfA,gBAHe;AAAA,UAIfE,eAJe,WAIfA,eAJe;AAAA,UAKfC,gBALe,WAKfA,gBALe;AAAA,UAMfC,YANe,WAMfA,YANe;;;AASjB,UAAMmC,YAAY,SAAZA,SAAY,CAACzD,CAAD;AAAA,eAAOkB,iBAAiBlB,CAAjB,WAAP;AAAA,OAAlB;AACA,UAAM0D,WAAW,SAAXA,QAAW,CAAC1D,CAAD;AAAA,eAAOoB,gBAAgBpB,CAAhB,WAAP;AAAA,OAAjB;AACA,UAAM2D,YAAY,SAAZA,SAAY,CAAC3D,CAAD;AAAA,eAAOqB,iBAAiBrB,CAAjB,WAAP;AAAA,OAAlB;AACA,UAAM4D,QAAQ,SAARA,KAAQ,CAAC5D,CAAD;AAAA,eAAOsB,aAAatB,CAAb,WAAP;AAAA,OAAd;;AAEA,UAAMkE,IAAI9D,KAAK+D,MAAf;AACA,UAAM1C,gBAAgB,KAAKA,aAA3B;;AAEA,UAAMoC,OAAO,KAAKC,SAAL,GACV1D,IADU,CACLN,GADK,CAAb;;AAGA,UAAIoE,CAAJ,EAAO;AAAE;AACP;;;;AAIAL,aACGP,IADH,CACQ,MADR,EACgBpD,YADhB,EAEG6D,EAFH,CAEM,WAFN,EAEmBN,SAFnB,EAGGM,EAHH,CAGM,UAHN,EAGkBL,QAHlB,EAIGK,EAJH,CAIM,WAJN,EAImBJ,SAJnB,EAKGI,EALH,CAKM,OALN,EAKeH,KALf,EAMG1B,UANH,GAOGkC,QAPH,CAOY,GAPZ,EAQGC,SARH,CAQa,GARb,EAQkB,KAAK1C,UARvB;;AAUA;;;AAGAkC,aACGT,KADH,GAEGC,MAFH,CAEU,MAFV,EAGGC,IAHH,CAGQ,OAHR,EAGiB,iBAHjB,EAIGA,IAJH,CAIQ,MAJR,EAIgBpD,YAJhB,EAKG6D,EALH,CAKM,WALN,EAKmBN,SALnB,EAMGM,EANH,CAMM,UANN,EAMkBL,QANlB,EAOGK,EAPH,CAOM,WAPN,EAOmBJ,SAPnB,EAQGI,EARH,CAQM,OARN,EAQeH,KARf,EASGL,IATH,CASQ,UAACvD,CAAD,EAAIG,CAAJ;AAAA,iBAAUsB,cAAc6C,MAAd,CAAqBnE,CAArB,EAAwB,CAAxB,EAA2BH,CAA3B,CAAV;AAAA,SATR,EAUGkC,UAVH,GAWGkC,QAXH,CAWY,GAXZ,EAYGC,SAZH,CAYa,GAZb,EAYkB,KAAK1C,UAZvB;AAaD;;AAED;;;AAGAkC,WACGU,IADH,GAEGC,MAFH;;AAIA/C,oBAAc0C,MAAd,GAAuBD,CAAvB,CA5DiB,CA4DS;AAC3B;;;uCAEkB;AAAA;;AAAA,UAEf9D,IAFe,GAGb,KAAKmB,KAHQ,CAEfnB,IAFe;;;AAKjB,UAAM2C,uBAAuB,SAAvBA,oBAAuB,CAAC/C,CAAD,EAAO;AAAA,qCACT,OAAKgD,WAAL,GAAmBC,QAAnB,CAA4BjD,CAA5B,CADS;AAAA;AAAA,YAC3BkD,MAD2B;AAAA,YACnBC,MADmB;;AAElC,8BAAoBD,MAApB,UAA+BC,MAA/B;AACD,OAHD;;AAKA,UAAMe,IAAI9D,KAAK+D,MAAf;AACA,UAAMzC,gBAAgB,KAAKA,aAA3B;AACA,UAAMmB,OAAO,KAAKC,SAAL,GACV1C,IADU,CACLN,GADK,CAAb;;AAGA,UAAIoE,CAAJ,EAAO;AAAE;AACP;;;AAGArB,aACGX,UADH,GAEGkC,QAFH,CAEY,GAFZ,EAGGd,IAHH,CAGQ,WAHR,EAGqBP,oBAHrB,EAIGF,IAJH,CAIQxC,YAJR;;AAMA;;;AAGAwC,aACGO,KADH,GAEGC,MAFH,CAEU,MAFV,EAGGC,IAHH,CAGQ,IAHR,EAGc,OAHd,EAIGA,IAJH,CAIQ,OAJR,EAIiB,iBAJjB,EAKGA,IALH,CAKQ,WALR,EAKqBP,oBALrB,EAMGF,IANH,CAMQxC,YANR,EAOGkD,IAPH,CAOQ,UAACvD,CAAD,EAAIG,CAAJ;AAAA,iBAAUuB,cAAc4C,MAAd,CAAqBnE,CAArB,EAAwB,CAAxB,EAA2BH,CAA3B,CAAV;AAAA,SAPR,EAQGkC,UARH,GASGkC,QATH,CASY,GATZ;AAUD;;AAED;;;AAGAvB,WACG0B,IADH,GAEGC,MAFH;;AAIA9C,oBAAcyC,MAAd,GAAuBD,CAAvB;AACD;;;iCAEY;AAAA,UAETpD,MAFS,GAGP,KAAKS,KAHE,CAETT,MAFS;;;AAKX,WAAK2D,gBAAL;;AAEA,UAAI3D,MAAJ,EAAY;AACV,aAAK4D,gBAAL;AACD;AACF;;;wCAEsB;AAAA,UAARC,IAAQ,SAARA,IAAQ;;AACrB,UAAMnD,MAAM,KAAKA,GAAjB;AACA,UAAMe,SAAS,KAAKD,cAAL,EAAf;;AAEAqC,WACGtB,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,IAFR,cAEwB9B,GAFxB,EAGG8B,IAHH,CAGQ,WAHR,iBAGkCf,MAHlC,UAG6CA,MAH7C;AAID;;;wCAEsB;AAAA,UAARoC,IAAQ,SAARA,IAAQ;;AACrB,UAAMnD,MAAM,KAAKA,GAAjB;AACA,UAAMe,SAAS,KAAKD,cAAL,EAAf;;AAEAqC,WACGtB,MADH,CACU,GADV,EAEGC,IAFH,CAEQ,IAFR,cAEwB9B,GAFxB,EAGG8B,IAHH,CAGQ,WAHR,iBAGkCf,MAHlC,UAG6CA,MAH7C;AAID;;;kCAEa;AAAA,UAEVvB,MAFU,GAGR,KAAKO,KAHG,CAEVP,MAFU;;;AAKZ,UAAMQ,MAAM,KAAKA,GAAjB;AACA,UAAMoD,wBAAsBpD,GAA5B;AACA,UAAMqD,QAAQ,sBAAM,EAAN,yBAAyB7D,MAAzB,CAAd;;AAEA,aACE;AACE,uBAAe4D,KADjB;AAEE,eAAOC;AAFT,QADF;AAMD;;;+CAE0B;AAAA,UAEvBjE,IAFuB,GAGrB,KAAKW,KAHgB,CAEvBX,IAFuB;;;AAKzB,UAAM8B,OAAO,KAAKoC,aAAL,CAAmB,EAAElE,UAAF,EAAnB,CAAb;AACA,UAAM+D,OAAO,KAAKI,aAAL,CAAmB,EAAErC,UAAF,EAAnB,CAAb;;AAEA,aAAO;AACLA,kBADK;AAELiC;AAFK,OAAP;AAID;;;6BAEQ;AAAA,UAEL7D,MAFK,GAGH,KAAKS,KAHF,CAELT,MAFK;;;AAKP,UAAMkE,IAAI,KAAKC,wBAAL,EAAV;;AAEA,WAAKC,YAAL,CAAkBF,CAAlB;;AAEA,UAAIlE,MAAJ,EAAY;AACV,aAAKqE,YAAL,CAAkBH,CAAlB;AACD;;AAED,UAAMxD,MAAM,KAAKA,GAAjB;AACA,UAAM4D,2BAAyB5D,GAA/B;AAdO,UAgBLkB,IAhBK,GAiBHsC,CAjBG,CAgBLtC,IAhBK;;;AAmBP,aACE;AAAA;AAAA,UAAK,WAAW0C,SAAhB;AACG,aAAKC,WAAL,EADH;AAEG3C,aAAK4C,OAAL;AAFH,OADF;AAMD;;;;;kBAjYkB/E,Q","file":"index.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport {\n  scaleOrdinal,\n  schemeCategory20,\n  range,\n  pie as layout,\n  arc,\n  select,\n  event as lastEvent,\n  interpolate\n} from 'd3';\nimport {\n  createUniqueID,\n  defaultStyles\n} from '../../shared';\nimport ReactFauxDOM from 'react-faux-dom';\nimport PropTypes from 'prop-types';\nimport { Style } from 'radium';\nimport merge from 'lodash.merge';\n\nconst color = scaleOrdinal(schemeCategory20).domain(range(0, 20));\nconst pie = layout()\n  .value((d) => d.value)\n  .sort(null);\n\nconst getSliceFill = (d, i) => (\n  (d.data.color)\n    ? d.data.color\n    : color(i));\n\nconst getLabelText = (d) => d.data.key;\n\nexport default class PieChart extends PureComponent {\n  static get propTypes() {\n    return {\n      data: PropTypes.array.isRequired,\n      innerHoleSize: PropTypes.number,\n      size: PropTypes.number,\n      padding: PropTypes.number,\n      labels: PropTypes.bool,\n      styles: PropTypes.object,\n      mouseOverHandler: PropTypes.func,\n      mouseOutHandler: PropTypes.func,\n      mouseMoveHandler: PropTypes.func,\n      clickHandler: PropTypes.func\n    };\n  }\n\n  static get defaultProps() {\n    return {\n      size: 400,\n      innerHoleSize: 0,\n      padding: 2,\n      labels: false,\n      styles: {},\n      mouseOverHandler: () => {},\n      mouseOutHandler: () => {},\n      mouseMoveHandler: () => {},\n      clickHandler: () => {}\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.uid = createUniqueID(props);\n    this.currentSlices = [];\n    this.currentLabels = [];\n    this.tweenSlice = (slice, index) => {\n      const currentSlice = this.currentSlices[index];\n      const i = interpolate(currentSlice, slice);\n      this.currentSlices[index] = slice;\n      return (t) => this.getSliceArc()(i(t));\n    };\n  }\n\n  componentDidMount() {\n    this.initialise();\n  }\n\n  componentDidUpdate() {\n    this.transition();\n  }\n\n  getSliceArc() {\n    const {\n      padding\n    } = this.props;\n\n    const innerRadius = this.getInnerRadius();\n    const outerRadius = this.getOuterRadius();\n\n    return arc()\n      .innerRadius(innerRadius - padding)\n      .outerRadius(outerRadius - padding);\n  }\n\n  getLabelArc() {\n    const {\n      padding\n    } = this.props;\n\n    const outerRadius = this.getOuterRadius();\n    const radius = outerRadius - padding - ((20 * outerRadius) / 100);\n\n    return arc()\n      .outerRadius(radius)\n      .innerRadius(radius);\n  }\n\n  getOuterRadius() {\n    return this.props.size * 0.5;\n  }\n\n  getInnerRadius() {\n    return this.props.innerHoleSize * 0.5;\n  }\n\n  getSlices() {\n    const {\n      data\n    } = this.props;\n\n    const uid = this.uid;\n\n    return select(`#slices-${uid}`)\n      .datum(data)\n      .selectAll('path');\n  }\n\n  getLabels() {\n    const {\n      data\n    } = this.props;\n\n    const uid = this.uid;\n\n    return select(`#labels-${uid}`)\n      .datum(data)\n      .selectAll('text');\n  }\n\n  createSvgNode({ size }) {\n    const node = new ReactFauxDOM.Element('svg');\n    node.setAttribute('width', size);\n    node.setAttribute('height', size);\n    return node;\n  }\n\n  createSvgRoot({ node }) {\n    return select(node);\n  }\n\n  initialiseLabels() {\n    const text = this.getLabels()\n      .data(pie);\n\n    const getLabelArcTransform = (d) => {\n      const [labelX, labelY] = this.getLabelArc().centroid(d);\n      return `translate(${labelX}, ${labelY})`;\n    };\n\n    const currentLabels = this.currentLabels;\n\n    text\n      .enter()\n      .append('text')\n      .attr('dy', '.35em')\n      .attr('class', 'pie-chart-label')\n      .attr('transform', getLabelArcTransform)\n      .text(getLabelText)\n      .each((d) => currentLabels.push(d));\n  }\n\n  initialiseSlices() {\n    const {\n      mouseOverHandler,\n      mouseOutHandler,\n      mouseMoveHandler,\n      clickHandler\n    } = this.props;\n\n    const mouseover = (d) => mouseOverHandler(d, lastEvent);\n    const mouseout = (d) => mouseOutHandler(d, lastEvent);\n    const mousemove = (d) => mouseMoveHandler(d, lastEvent);\n    const click = (d) => clickHandler(d, lastEvent);\n\n    const currentSlices = this.currentSlices;\n\n    const path = this.getSlices()\n      .data(pie);\n\n    path\n      .enter()\n      .append('path')\n      .attr('class', 'pie-chart-slice')\n      .attr('fill', getSliceFill)\n      .attr('d', this.getSliceArc())\n      .on('mouseover', mouseover)\n      .on('mouseout', mouseout)\n      .on('mousemove', mousemove)\n      .on('click', click)\n      .each((d) => currentSlices.push(d));\n  }\n\n  initialise() {\n    const {\n      labels\n    } = this.props;\n\n    this.initialiseSlices();\n\n    if (labels) {\n      this.initialiseLabels();\n    }\n  }\n\n  transitionSlices() {\n    const {\n      data,\n      mouseOverHandler,\n      mouseOutHandler,\n      mouseMoveHandler,\n      clickHandler\n    } = this.props;\n\n    const mouseover = (d) => mouseOverHandler(d, lastEvent);\n    const mouseout = (d) => mouseOutHandler(d, lastEvent);\n    const mousemove = (d) => mouseMoveHandler(d, lastEvent);\n    const click = (d) => clickHandler(d, lastEvent);\n\n    const n = data.length;\n    const currentSlices = this.currentSlices;\n\n    const path = this.getSlices()\n      .data(pie);\n\n    if (n) { // we don't need to do this, but it's fun\n      /*\n       * Change current slices\n       * Transition current slice dimensions\n       */\n      path\n        .attr('fill', getSliceFill)\n        .on('mouseover', mouseover)\n        .on('mouseout', mouseout)\n        .on('mousemove', mousemove)\n        .on('click', click)\n        .transition()\n        .duration(750)\n        .attrTween('d', this.tweenSlice);\n\n      /*\n       * Add new slices\n       */\n      path\n        .enter()\n        .append('path')\n        .attr('class', 'pie-chart-slice')\n        .attr('fill', getSliceFill)\n        .on('mouseover', mouseover)\n        .on('mouseout', mouseout)\n        .on('mousemove', mousemove)\n        .on('click', click)\n        .each((d, i) => currentSlices.splice(i, 1, d))\n        .transition()\n        .duration(750)\n        .attrTween('d', this.tweenSlice);\n    }\n\n    /*\n     * Remove old slices\n     */\n    path\n      .exit()\n      .remove();\n\n    currentSlices.length = n; // = this.currentSlices.slice(0, n)\n  }\n\n  transitionLabels() {\n    const {\n      data\n    } = this.props;\n\n    const getLabelArcTransform = (d) => {\n      const [labelX, labelY] = this.getLabelArc().centroid(d);\n      return `translate(${labelX}, ${labelY})`;\n    };\n\n    const n = data.length;\n    const currentLabels = this.currentLabels;\n    const text = this.getLabels()\n      .data(pie);\n\n    if (n) { // we don't need to do this, but it's fun\n      /*\n       * Change current labels\n       */\n      text\n        .transition()\n        .duration(750)\n        .attr('transform', getLabelArcTransform)\n        .text(getLabelText);\n\n      /*\n       * Add new labels\n       */\n      text\n        .enter()\n        .append('text')\n        .attr('dy', '.35em')\n        .attr('class', 'pie-chart-label')\n        .attr('transform', getLabelArcTransform)\n        .text(getLabelText)\n        .each((d, i) => currentLabels.splice(i, 1, d))\n        .transition()\n        .duration(750);\n    }\n\n    /*\n     * Remove old labels\n     */\n    text\n      .exit()\n      .remove();\n\n    currentLabels.length = n;\n  }\n\n  transition() {\n    const {\n      labels\n    } = this.props;\n\n    this.transitionSlices();\n\n    if (labels) {\n      this.transitionLabels();\n    }\n  }\n\n  createSlices({ root }) {\n    const uid = this.uid;\n    const radius = this.getOuterRadius();\n\n    root\n      .append('g')\n      .attr('id', `slices-${uid}`)\n      .attr('transform', `translate(${radius}, ${radius})`);\n  }\n\n  createLabels({ root }) {\n    const uid = this.uid;\n    const radius = this.getOuterRadius();\n\n    root\n      .append('g')\n      .attr('id', `labels-${uid}`)\n      .attr('transform', `translate(${radius}, ${radius})`);\n  }\n\n  createStyle() {\n    const {\n      styles\n    } = this.props;\n\n    const uid = this.uid;\n    const scope = `.pie-chart-${uid}`;\n    const rules = merge({}, defaultStyles, styles);\n\n    return (\n      <Style\n        scopeSelector={scope}\n        rules={rules}\n      />\n    );\n  }\n\n  calculateChartParameters() {\n    const {\n      size\n    } = this.props;\n\n    const node = this.createSvgNode({ size });\n    const root = this.createSvgRoot({ node });\n\n    return {\n      node,\n      root\n    };\n  }\n\n  render() {\n    const {\n      labels\n    } = this.props;\n\n    const p = this.calculateChartParameters();\n\n    this.createSlices(p);\n\n    if (labels) {\n      this.createLabels(p);\n    }\n\n    const uid = this.uid;\n    const className = `pie-chart-${uid}`;\n    const {\n      node\n    } = p;\n\n    return (\n      <div className={className}>\n        {this.createStyle()}\n        {node.toReact()}\n      </div>\n    );\n  }\n}\n"]}